<ResourceDictionary
   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
   xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
   xmlns:vm="clr-namespace:VentWPF.ViewModel">
   <ItemsPanelTemplate x:Key="dd">
      <StackPanel
         Width="auto"
         VerticalAlignment="Center"
         Orientation="Horizontal"/>
   </ItemsPanelTemplate>
   <DataTemplate x:Key="t" DataType="{x:Type vm:Element}">
      <Image Height="150" Source="{Binding SchemeImage}"/>
   </DataTemplate>
   <DataTemplate x:Key="b" DataType="{x:Type vm:Element}">
      <StackPanel>
         <Image
            Height="150"
            Stretch="Fill"
            Source="{Binding SchemeImage}"/>
         <TextBox Text="{Binding Length, Mode=OneWay}" Style="{StaticResource under}"/>
      </StackPanel>
   </DataTemplate>
   <DataTemplate DataType="{x:Type vm:SchemeVM}">
      <Grid>
         <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition/>
         </Grid.ColumnDefinitions>
         <Grid Grid.Column="0"
            x:Name="scheme"
            Width="auto"
            VerticalAlignment="Center"
            ShowGridLines="True">
            <b:Interaction.Triggers>
               <b:EventTrigger EventName="Loaded">
                  <b:InvokeCommandAction Command="{Binding Parent.CmdLinkGui}" CommandParameter="{Binding ElementName=scheme}"/>
               </b:EventTrigger>
            </b:Interaction.Triggers>
            <Grid.RowDefinitions>
               <RowDefinition Height="auto"/>
               <RowDefinition Height="auto"/>
               <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
               <ColumnDefinition Width="auto"/>
               <ColumnDefinition Width="auto"/>
               <ColumnDefinition Width="auto"/>
            </Grid.ColumnDefinitions>
            <!--  Верхние элементы  -->
            <ItemsControl Grid.Row="0" Grid.Column="3"
               ItemsPanel="{StaticResource dd}"
               ItemTemplate="{StaticResource t}"
               ItemsSource="{Binding TopElements}"/>
            <!--  Нижние элементы  -->
            <ItemsControl Grid.Row="1" Grid.Column="3"
               ItemsPanel="{StaticResource dd}"
               ItemTemplate="{StaticResource b}"
               ItemsSource="{Binding BottomElements}"/>
            <!--  Левый верхний текст  -->
            <Canvas Grid.Row="0" Grid.RowSpan="2" Grid.Column="0"
               Width="30"
               Visibility="{Binding TwoRows, Mode=OneWay, Converter={StaticResource visConv}}">
               <TextBox
                  Width="300"
                  Height="25"
                  Margin="30 0 0 0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  ClipToBounds="False"
                  IsHitTestVisible="False"
                  Style="{StaticResource under}"
                  Text="{Binding WidthTop, Mode=OneWay}"
                  TextAlignment="Center">
                  <TextBox.RenderTransform>
                     <RotateTransform Angle="90"/>
                  </TextBox.RenderTransform>
               </TextBox>
            </Canvas>
            <Canvas Grid.Row="0" Grid.Column="1"
               Width="30"
               Visibility="{Binding TwoRows, Mode=OneWay, Converter={StaticResource visConv}}">
               <TextBox
                  Width="150"
                  Height="25"
                  Margin="30 0 0 0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  ClipToBounds="False"
                  IsHitTestVisible="False"
                  Style="{StaticResource under}"
                  Text="{Binding WidthTop, Mode=OneWay}"
                  TextAlignment="Center">
                  <TextBox.RenderTransform>
                     <RotateTransform Angle="90"/>
                  </TextBox.RenderTransform>
               </TextBox>
            </Canvas>
            <Canvas Grid.Row="1" Grid.Column="1"
               Width="30"
               Visibility="{Binding TwoRows, Mode=OneWay, Converter={StaticResource visConv}}">
               <TextBox
                  Width="150"
                  Height="25"
                  Margin="30 0 0 0"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  ClipToBounds="False"
                  IsHitTestVisible="False"
                  Style="{StaticResource under}"
                  Text="{Binding WidthTop, Mode=OneWay}"
                  TextAlignment="Center">
                  <TextBox.RenderTransform>
                     <RotateTransform Angle="90"/>
                  </TextBox.RenderTransform>
               </TextBox>
            </Canvas>
            <!--  Левый общий текст  -->
            <TextBox Grid.Row="2" Grid.Column="2"
               Text="{Binding Sum, Mode=OneWay}"
               Style="{StaticResource under}"/>
         </Grid>
      </Grid>



   </DataTemplate>
</ResourceDictionary>